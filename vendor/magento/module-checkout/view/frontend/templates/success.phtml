<?php
/**
 * Copyright Â© Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */

// @codingStandardsIgnoreFile

?>
<?php /** @var $block \Magento\Checkout\Block\Onepage\Success */ ?>
<!----BEGIN BITPAY CHECKOUT --->
<?php

$objectManager = \Magento\Framework\App\ObjectManager::getInstance();

if($block->getOrderId() && isset($_COOKIE['modal']) && isset($_COOKIE['invoicedata'])): 

$env         = $objectManager->get('Magento\Framework\App\Config\ScopeConfigInterface')->getValue('payment/bpcheckout/bitpay_endpoint');
$invoiceData = $_COOKIE['invoicedata'];
#delete the cookie, comment to leave and test on refresh
setcookie("invoicedata", '', time() - 3600,"/");
setcookie("modal", '', time() - 3600, "/");


?>
<script type = "text/javascript">

function hideOrder(){
    setTimeout(function(){ 
     jQuery(".page-main").hide()
     showModal('<?php echo $env;?>','<?php echo $invoiceData;?>')
   
    }, 
    1000);   
}
hideOrder()



</script>
<?php endif;?>
<!----END BITPAY CHECKOUT--->

<div class="checkout-success">
    <?php if ($block->getOrderId()):?>
        <?php if ($block->getCanViewOrder()) :?>
            <p><?= __('Your order number is: %1.', sprintf('<a href="%s" class="order-number"><strong>%s</strong></a>', $block->escapeHtml($block->getViewOrderUrl()), $block->escapeHtml($block->getOrderId()))) ?></p>
        <?php  else :?>
            <p><?= __('Your order # is: <span>%1</span>.', $block->escapeHtml($block->getOrderId())) ?></p>
        <?php endif;?>
            <p><?= /* @escapeNotVerified */ __('We\'ll email you an order confirmation with details and tracking info.') ?></p>
    <?php endif;?>

    <?= $block->getAdditionalInfoHtml() ?>

    <div class="actions-toolbar">
        <div class="primary">
            <a class="action primary continue" href="<?= /* @escapeNotVerified */ $block->getContinueUrl() ?>"><span><?= /* @escapeNotVerified */ __('Continue Shopping') ?></span></a>
        </div>
    </div>
</div>
